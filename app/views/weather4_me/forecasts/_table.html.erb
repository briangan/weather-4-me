<% 
=begin
  Require locals:
    forecasts: Array of Forecast
=end
  current_timezone = Timezone['America/New_York']
-%>
<table class="data-table">
  <thead>
    <tr>
      <th>Location</th>
      <th>Current temp</th>
      <th>Low temp</th>
      <th>High temp</th>
      <th>Condition</th>
      <th>Forecast time</th>
    </tr>
  </thead>

  <tbody>
    <% forecasts.each do |forecast| %>
      <tr>
        <td><%= forecast.location&.to_short_s %></td>
        <td data-column="current_temp"><%= forecast.current_temp %></td>
        <td data-column="low_temp"><%= forecast.low_temp %></td>
        <td data-column="high_temp"><%= forecast.high_temp %></td>
        <td data-column="condition"><%= forecast.condition %></td>
        <td data-column="forecast_time">
          <% # This may need to change to the location timezone -%>
          <%= current_timezone.utc_to_local(forecast.forecast_time).strftime('%I:%M %P') %>
        </td>
      </tr>
      <% if @hourly_forecasts.present? %>
        <tr>
          <td colspan="6">
            <h4>Hourly Forecasts</h4>
            <div id="hourly_forecasts" style="overflow-x: scroll;">
              <% @hourly_forecasts.each do |hourly| %>
                <span class="hourly-cell">
                  <span class="hour-text"><%= current_timezone.utc_to_local(hourly.time).strftime('%l %P') %></span>
                  <br/>
                  <span class="temperature-text"><%= hourly.temp %></span>
                  <br/>
                  <small><%= hourly.condition %></small>
                </span>
              <% end %>
            </div>
          </td>
        </tr>
      <% end # @hourly_forecasts -%>
    <% end %>
  </tbody>
</table>